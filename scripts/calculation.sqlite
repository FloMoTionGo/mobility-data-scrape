/*
 * SQLite CREATE TABLE
 * Released under the Creative Commons License.
 */
.mode column
--.output vbb.db
CREATE TABLE dailyVBB AS
SELECT
  strftime('%Y%m%d', created_at) as Date_in_ymd
, count(substr(id, 3,5)) AS Count_per_day_VBB
from vbb
group by Date_in_ymd;

CREATE TABLE dailyTIER AS
SELECT
  strftime('%Y%m%d', created_at) as Date_in_ymd
, count(substr(id, 3,5)) AS Count_per_day_TIER
from TIER
group by Date_in_ymd;

select
  dailyVBB.Date_in_ymd
, Count_per_day_TIER
, Count_per_day_VBB
, round(Count_per_day_TIER / CAST(Count_per_day_VBB AS real),2) as ratio
from dailyTIER
inner join dailyVBB
on dailyVBB.Date_in_ymd = dailyTIER.Date_in_ymd;
